(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[      4190,        142]
NotebookOptionsPosition[      3636,        117]
NotebookOutlinePosition[      4004,        133]
CellTagsIndexPosition[      3961,        130]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["ProjectEuler Problem 45", "Title",
 CellChangeTimes->{{3.536325645546378*^9, 3.5363256521063433`*^9}}],

Cell["\<\
Triangle, pentagonal, and hexagonal numbers are generated by the following \
formulae:

Triangle\t \tTn=n(n+1)/2\t \t1, 3, 6, 10, 15, ...
Pentagonal\t \tPn=n(3n-1)/2\t \t1, 5, 12, 22, 35, ...
Hexagonal\t \tHn=n(2n-1)\t \t1, 6, 15, 28, 45, ...
It can be verified that T285 = P165 = H143 = 40755.

Find the next triangle number that is also pentagonal and hexagonal.\
\>", "Text",
 CellChangeTimes->{{3.536325656957013*^9, 3.536325675087037*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"penQ", "[", "x_", "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"1", "+", 
      SqrtBox[
       RowBox[{"1", "+", 
        RowBox[{"24", "*", "x"}]}]]}], "6"], "\[Element]", "Integers"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hex", "[", "x_", "]"}], ":=", 
   RowBox[{"n", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "n"}], "-", "1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "145"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"While", " ", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"penQ", "[", 
      RowBox[{"hex", "[", "n", "]"}], "]"}]}], ",", 
    RowBox[{"n", "++"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"hex", "[", "n", "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5363257379932346`*^9, 3.5363260281492167`*^9}, {
   3.536326082126899*^9, 3.5363262243720045`*^9}, 3.5363262565572205`*^9, {
   3.5363262962176523`*^9, 3.53632630563579*^9}, {3.536326502097191*^9, 
   3.536326529437953*^9}}],

Cell[BoxData["1533776805"], "Print",
 CellChangeTimes->{{3.5363259804186893`*^9, 3.536326028572241*^9}, {
   3.5363261024086533`*^9, 3.5363261301258383`*^9}, {3.5363261621252675`*^9, 
   3.536326188437169*^9}, {3.536326219157909*^9, 3.5363262247872267`*^9}, 
   3.5363262701973925`*^9, {3.536326300485896*^9, 3.536326309059986*^9}, {
   3.536326518057302*^9, 3.536326533275172*^9}, 3.5363973668056417`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NestWhile", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "+", "#"}], "&"}], ",", "286", ",", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"Element", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"1", "+", 
             RowBox[{"24", "*", "#", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "*", "#"}], "-", "1"}], ")"}]}]}], "]"}]}], 
          ")"}], "/", "6"}], ",", "Integers"}], "]"}]}], "&"}]}], "]"}], "//", 
  RowBox[{
   RowBox[{"#", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "#"}], "-", "1"}], ")"}]}], "&"}]}]], "Input",
 CellChangeTimes->{{3.5363270769805584`*^9, 3.536327076984558*^9}}],

Cell[BoxData["1533776805"], "Output",
 CellChangeTimes->{3.536327082162053*^9, 3.536397374948856*^9}]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{707, 505},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Microsoft Windows (32-bit) (October 6, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 108, 1, 83, "Title"],
Cell[690, 25, 454, 11, 155, "Text"],
Cell[CellGroupData[{
Cell[1169, 40, 1102, 33, 135, "Input"],
Cell[2274, 75, 406, 5, 23, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2717, 85, 787, 25, 52, "Input"],
Cell[3507, 112, 101, 1, 30, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
