<html><head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"><title>INC 2013 - C</title>

<style>
body {
	font-family: "Arial";
	font-size: 10pt;
}
</style>

</head><body><com:tcontent id="body">
<center>
<h3>ACM-ICPC Indonesia National Contest 2013</h3>
<h2>Problem C</h2>
<h1>Brain "Perfect" Scheme</h1>
Time Limit: 2 seconds
</center>
<br>

<p>Brain, an intelligent mouse who has undergone a significant genetic 
alteration, is an evil mastermind. He has an ever-lasting desire to take
 over the world with his "perfect" evil scheme<sup>1</sup>. Brain has a 
good friend, Pinky, who is also a mutant mouse, but is not so 
intelligent when compared to Brain. However, Pinky is more open-minded, 
friendly, sensitive, and sweet, which makes him adorable.</p>

<p>For his new "perfect" evil scheme, Brain needs to compute N 
computational jobs in some servers (jobs are numbered from 1 to N). Each
 job i has to be executed strictly from start time s<sub>i</sub> to ending time e<sub>i</sub>
 in one machine continuously without any interruption. Of course, Brain 
can just use N servers to run each jobs independently to each other; 
however, this alternative is very costly and Brain is getting poor from 
preparing his previous world-domination scheme. Therefore, he wants to 
minimize the number of needed server to complete all his jobs.</p>

<p>To make the matter worse, apparently it takes some time for a server 
to switch from one job to another. If a server finishes job j<sub>x</sub>, then to start job j<sub>y</sub> it will need an intermission time t<sub>x,y</sub> after job j<sub>x</sub> completes. This is the time required by the server to clean up job j<sub>x</sub> and load job j<sub>y</sub>. In other word, job j<sub>y</sub> can be run after job j<sub>x</sub> if and only if e<sub>x</sub> + t<sub>x,y</sub> &#8804; s<sub>y</sub>.</p>

<p>For example, let there be 3 jobs
</p><pre>s<sub>1</sub> =  3 and e<sub>1</sub> =  6
s<sub>2</sub> = 10 and e<sub>2</sub> = 15
s<sub>3</sub> = 16 and e<sub>3</sub> = 20
t<sub>1,2</sub> = 2,  t<sub>1,3</sub> = 5
t<sub>2,1</sub> = 0,  t<sub>2,3</sub> = 3
t<sub>3,1</sub> = 0,  t<sub>3,2</sub> = 0
</pre>
In this example, we need 2 servers:
<pre>Server 1: j<sub>1</sub>, j<sub>2</sub>
Server 2: j<sub>3</sub>
</pre>
Note that we cannot execute job j<sub>3</sub> in the same server as job j<sub>2</sub> because e<sub>2</sub> + t<sub>2,3</sub> &gt; s<sub>3</sub>, i.e. the server can't prepare the intermission between j<sub>2</sub> and j<sub>3</sub> in time.<p></p>

<p>Brain has instructed Pinky to solve this problem, i.e. to find the 
minimum number of required server to finish all the jobs. Unfortunately,
 Pinky is not very bright (a.k.a. stupid). He needs your help to solve 
Brain's problem. You're going to help him right? He's adorable! We can't
 help it.</p>

<br>

<p><sup>1</sup> The quote on "perfect" actually means he often makes a 
small fatal mistake which causes the plan to completely fail. Hence, he 
has never actually succeeded in conquering the world... yet.</p>

<br>

<h3>Input</h3>
<p>The first line of input contains an integer T (1 &#8804; T &#8804; 100) the 
number of cases. Each case begins with one integer N (1 &#8804; N &#8804; 100) in a 
line. The next N lines each contains two integers s<sub>i</sub> and e<sub>i</sub> (1 &#8804; s<sub>i</sub> &lt; e<sub>i</sub> &#8804; 10<sup>5</sup>) denoting the start time and ending time of job j<sub>i</sub> respectively. The following N lines each contains N integers t<sub>x,y</sub> (0 &#8804; t<sub>x,y</sub> &#8804; 10<sup>5</sup>). The y<sup>th</sup> integer on x<sup>th</sup> line of this matrix denotes the intermission time from job j<sub>x</sub> to job j<sub>y</sub>. t<sub>x,x</sub> will be 0 for all x.</p>


<p></p>

<h3>Output</h3>
<p>For each case, output in a line the "<font face="Courier New">Case #X: Y</font>" where <font face="Courier New">X</font> is the case number starts from 1, and <font face="Courier New">Y</font> is the number of minimum server required to finish all the jobs.</p>
<br>

<br><table bgcolor="#000000" border="0" cellpadding="0" cellspacing="0">
<tbody><tr><td>
<table width="600" border="0" cellpadding="4" cellspacing="1">
<tbody><tr><th width="250" align="left" bgcolor="#FFFFFF">Sample Input</th><th width="250" align="left" bgcolor="#FFFFFF">Output for Sample Input</th></tr>
<tr valign="top"><td bgcolor="#FFFFFF"><pre>3
3
3 6
10 15
16 20
0 2 5
0 0 3
0 0 0
4
8 10
4 7
12 15
1 4
0 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0
4
8 10
4 7
12 15
1 4
0 50 50 50
50 0 50 50
50 50 0 50
50 50 50 0</pre>
</td><td bgcolor="#FFFFFF"><pre>Case #1: 2
Case #2: 1
Case #3: 4
</pre>
</td></tr>
</tbody></table>
</td></tr>
</tbody></table>

<br><br>
<p><i>Explanation for the 2<sup>nd</sup> sample input.</i></p>
<p>We can execute all jobs in one machine.</p>

<p><i>Explanation for the 3<sup>rd</sup> sample input.</i></p>
<p>The jobs are the same as 2<sup>nd</sup> sample input, but now the intermission times are huge. Therefore, we need to run each job in separated server independently.</p>

<br><br>
</com:tcontent></body></html>