
<!-- saved from url=(0061)http://competition.binus.ac.id/contest/team/problem.php?id=29 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252"><title>INC 2016 - I. Irpin's Walk</title>

<style>
body, p, li, td {
	font-family: "Arial";
	font-size: 12pt;
	line-height: 1.5;
}
li {
	padding-bottom: 10px;
}
.norm{
	font-family: "Cambria Math";
	font-size: 13pt;
}
.block{
	display: block;
	margin-left: auto;
	margin-right: auto;	
}
</style>

</head><body><com:tcontent id="body">
<center>
<h3>ACM-ICPC Indonesia National Contest 2016</h3>
<h2>Problem I</h2>
<h1>Irpin's Walk</h1>
Time Limit: 7 seconds
</center>
<br>

<p>Irpin loves to walk around in the city where he lives. There are N intersections (numbered from 1 to N) and M bidirectional roads in the city where each road connects exactly two different intersections. Two intersections may have more than one roads connecting them because the mayor wants people to have many alternatives for their journey in the city, e.g., one can use a shorter and posibly boring road, or one can use a longer road with nice scenery.</p>

<p>A <i>walk</i> in the city is defined as an alternating sequence of intersections and roads (starting and ending at an intersection), in which each road in the sequence is incident to both of its adjacent roads. Note that, unlike a <i>path</i>, a walk may have repeating intersections and roads in its sequence.</p>

<p>Let W (walk's length) be the sum of all road's length in the walk, and R be the number of roads in the walk. If 2<sup>R</sup> &#8804; W, then the cost of the walk is 2*W; otherwise the cost will simply be W. If you're wondering why such confusing method to calculate the walk cost, Irpin felt a short walk (walk which uses only few number of roads) is kind of "cheating"; therefore, he doubles the cost of any short walks, i.e. become 2*W instead of W.</p>

<p>Suppose Irpin wants to have a walk from intersection A to intersection B, help him determine the minimum cost walk among all possible walks from A to B.</p>

<br>

<h3>Input</h3>
<p>The first line of input contains an integer T (T &#8804; 50) denoting the number of cases. Each case begins with four integers: N M A B (2 &#8804; N &#8804; 10,000; 1 &#8804; M &#8804; 100,000; 1 &#8804; A, B &#8804; N; A &#8800; B) representing the number of intersections, the number of roads, intersection in which the walk starts, and intersection in which the walk ends, respectively. The following M lines each contains three integers: u v w (1 &#8804; u, v &#8804; N; u &#8800; v; 1 &#8804; w &#8804; 1,000) representing a bidirectional road of length w which connects intersection u and v.
</p>


<h3>Output</h3>
<p>For each case, output in a line "<font face="Courier New">Case #X:</font>" where <font face="Courier New">X</font> is the case number, starts from 1, and <font face="Courier New">Y</font> is the cost of the walk with minimum cost from A to B for that particular case. If there is no possible walk from A to B, then output -1 for <font face="Courier New">Y</font>.</p>


<br><table border="0" cellspacing="0" cellpadding="0" bgcolor="#000000">
<tbody><tr><td align="center">
<table border="0" cellspacing="1" cellpadding="4" width="700">
<tbody><tr><th align="left" width="*" bgcolor="#FFFFFF">Sample Input</th><th align="left" width="250" bgcolor="#FFFFFF">Output for Sample Input</th></tr>
<tr valign="top"><td bgcolor="#FFFFFF">
<pre>3
5 5 1 3
1 2 2
2 3 1
1 4 2
4 5 2
5 3 1
5 5 1 3
1 2 3
2 3 2
1 4 3
4 5 2
5 3 2
3 1 1 3
1 2 3
</pre>
</td><td bgcolor="#FFFFFF">
<pre>Case #1: 3
Case #2: 7
Case #3: -1
</pre>
</td></tr>
</tbody></table>
</td></tr>
</tbody></table>

<br><br>
<p><i>Explanation for 1<sup>st</sup> sample case</i></p>
<p></p>The walk with minimum cost is 1 - 2 - 3. The walk length W is 2 + 1 = 3, while the number of roads R is 2. As 2<sup>R</sup> = 2<sup>2</sup> = 4 is larger than W = 3, then the cost is 3.<p></p>
<br>
<p><i>Explanation for 2<sup>nd</sup> sample case</i></p>
<p></p>Follows are two possible walks (among many other) from intersection 1 to 3:
<ul>
<li>1 - 2 - 3; in this walk, W = 3 + 2 = 5, and R = 2. Since 2<sup>R</sup> = 2<sup>2</sup> = 4 is no more than W = 5, then cost for this walk is 2 * W = 2 * 5 = 10.</li>
<li>1 - 4 - 5 - 3; in this walk, W = 3 + 2 + 2 = 7, and R = 3. Since 2<sup>R</sup> = 2<sup>3</sup> = 8 is more than W = 7, then cost for this walk is W = 7.</li>
</ul>
Of course there are infinitely many other walks from intersection 1 to 3, but among all of them, walk 1 - 4 - 5 - 3 has the lowest cost of 7.
<p></p>
<br>
<p><i>Explanation for 3<sup>rd</sup> sample case</i></p>
<p></p>There are no possible walk from intersection 1 to 3.<p></p>
<br>


<br><br>
</com:tcontent><script type="text/javascript">( function(){ window.SIG_EXT = {}; } )()</script></body></html>