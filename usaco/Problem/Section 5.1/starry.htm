<html><head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
 <title>Problem 55: Starry Night</title> </head><body 
background="starry_files/bg3.jpg">
<img src="starry_files/cow1.jpg" width="742" height="118">
<center>
<b><font size="7">Starry Night</font></b><br>
<b>IOI 98</b>
</center>


<p>High up in the night sky, the shining stars appear in clusters of
various shapes. A <b>cluster</b> is a non-empty group of neighbouring
stars, adjacent in horizontal, vertical or diagonal direction. A cluster
cannot be a part of a larger cluster.

</p><p>Clusters may be similar. Two clusters are <b>similar</b> if they 
have
the same shape and number of stars, irrespective of their orientation.
In general, the number of possible orientations for a cluster is eight,
as Figure 1 exemplifies.

</p><p> <img src="starry_files/starry-1.gif" alt="Figure 1. Eight 
similar clusters">

<br><i>Figure 1. Eight similar clusters</i>

</p><p>The night sky is represented by a sky map, which is a 
two-dimensional
matrix of 0's and 1's. A cell contains the digit 1 if it has a star,
and the digit 0 otherwise.

</p><p>Given a sky map, mark all the clusters with lower case letters.
Similar clusters must be marked with the same letter; non-similar
clusters must be marked with different letters.

</p><p>You mark a cluster with a lower case letter by replacing every 1 
in
the cluster by that lower case letter.

</p><h3>PROGRAM NAME: starry</h3>

<h3>INPUT FORMAT</h3>

<p>The first two lines contain, respectively, the width <b>W</b> and
the height <b>H</b> of a sky map. The sky map is given in the following
<b>H</b> lines, of <b>W</b> characters each.

</p><h3>SAMPLE INPUT (file starry.in) </h3>

<code>
23<br>
15<br>
10001000000000010000000<br>
01111100011111000101101<br>
01000000010001000111111<br>
00000000010101000101111<br>
00000111010001000000000<br>
00001001011111000000000<br>
10000001000000000000000<br>
00101000000111110010000<br>
00001000000100010011111<br>
00000001110101010100010<br>
00000100110100010000000<br>
00010001110111110000000<br>
00100001110000000100000<br>
00001000100001000100101<br>
00000001110001000111000<br>
</code>

In this case, the sky map has width 23 and height 15. Just to make it
clearer, notice that this input file corresponds to the following
picture of the sky.

<p> <img src="starry_files/starry-2.gif" alt="Figure 2. Picture of the
sky"><br> <i>Figure 2. Picture of the sky</i></p><p>


</p><h3>OUTPUT FORMAT</h3>

<p>The output file contains the same map as the input file, except that
the clusters are marked as described in Task.

</p><p>There will generally be more than one way to label the clusters 
with
letters.  Your program should choose the labeling such that if the
entire output file is read as a string, this string will be minimal in
the lexicographical ordering.


</p><h3>SAMPLE OUTPUT (file starry.out)</h3>

<code>
a000a0000000000b0000000<br>
0aaaaa000ccccc000d0dd0d<br>
0a0000000c000c000dddddd<br>
000000000c0b0c000d0dddd<br>
00000eee0c000c000000000<br>
0000e00e0ccccc000000000<br>
b000000e000000000000000<br>
00b0f000000ccccc00a0000<br>
0000f000000c000c00aaaaa<br>
0000000ddd0c0b0c0a000a0<br>
00000b00dd0c000c0000000<br>
000g000ddd0ccccc0000000<br>
00g0000ddd0000000e00000<br>
0000b000d0000f000e00e0b<br>
0000000ddd000f000eee000<br>
</code>

This is one possible result for the sample input above. Notice that this
output file corresponds to the following picture.<p>

<img src="starry_files/starry-3.gif"><br>
<i>Figure 3. Picture with the clusters marked</i></p><p>

</p><h3>Constraints</h3>
0 &lt;= <b>W</b> (width of the sky map) &lt;= 100<br>
0 &lt;= <b>H</b> (height of the sky map) &lt;= 100<br>
0 &lt;= Number of clusters &lt;= 500<br>
0 &lt;= Number of non-similar clusters &lt;= 26 (a..z)<br>
1 &lt;= Number of stars per cluster &lt;= 160<br>
<br>
<hr>
<form action="/upload3" enctype="multipart/form-data" method="POST">
<b>Submission file Name:</b> <input name="filename" type="file">
<input value="Send it in!" type="submit">
<input name="a" value="Zeq1JEUeQxb" type="hidden">
<input name="S" value="starry" type="hidden">
</form>

<center>
<a href="http://ace.delos.com/usacogate?a=Zeq1JEUeQxb"> USACO Gateway </a>
 &nbsp;| &nbsp;
<a href="mailto:kolstad@ace.delos.com">Comment or Question </a>
</center>
</body></html>